<script>

/**
 * Populates #sideBar with links; <url>?page=links[i]
 *
 * @param {url} the webapp url via getScriptUrl()
 */
function populateSidebar(url){
  const links = ['Info', 'Assigned_Staff', 'Schedule', 'Insurance', 'Authorization', 'Medical', 'Report', 'Documents', 'Intake']
  const l =     ['Info', 'Assigned Staff', 'Schedule', 'Insurance', 'Authorization', 'Medical', 'Report', 'Documents', 'Intake']
  const sidebar = $('#sideBar')
  sidebar.empty()
  for(let i = 0, j = links.length; i < j; i++){
    sidebar.append('<li class="nav-item">' +
                     '<a class="nav-link active" href="' + url + '?page='+ links[i] + '">' + l[i] + '</a>' +
                   '</li>')
  }
}

$("#menu-toggle").click(function(e) {
  e.preventDefault();
  $("#wrapper").toggleClass("toggled");
});
function showLinkStatus(clientId){
  console.log(data[clientId-1]['IacStatus'])
  let client = data[clientId-1]
  if(clientId==client['ClientId']){
    $('#folderLink').attr("href",client['FolderLink']);
    $('#iacStatus').empty();
    if(client['IacStatus'] == 'Active'){
      $('#iacStatus').html(client['IacStatus']);
      $('#iacStatus').removeClass('statusInactive')
      $('#iacStatus').addClass('statusActive')
    }
    else{
      $('#iacStatus').html(client['IacStatus']);    
      $('#iacStatus').removeClass('statusActive')
      $('#iacStatus').addClass('statusInactive')
      }
  }
  else{
    $.each(data,function(index,row){
      if(clientId==row['ClientId']){
        $('#folderLink').attr("href",row['FolderLink']);
        $('#iacStatus').empty();
        if(client['IacStatus'] == 'Active'){
          $('#iacStatus').html(row['IacStatus']);
          $('#iacStatus').removeClass('statusInactive')
          $('#iacStatus').addClass('statusActive')
        }
       else{
          $('#iacStatus').html(row['IacStatus']);    
          $('#iacStatus').removeClass('statusActive')
          $('#iacStatus').addClass('statusInactive')
        }
      }
    });
  }
}
$(document).ready(function() {
  google.script.run.withSuccessHandler(populateSidebar).getScriptUrl();
    $('#clientSelect').select2({
      width:'100%'
    });
    google.script.run.withSuccessHandler(getClients).loadClients();
});
function getClients(clientList)
{
    data = JSON.parse(clientList);
    selectFill(data);
}

function selectFill(clientList){
  $.each(clientList,function(index,row){
    var fillName = row["Name"]
    var fillClientId = row["ClientId"];
    var o = new Option( fillName+' | Client Id: '+fillClientId, fillClientId);
    $("#clientSelect").append(o);
    });
}
</script>